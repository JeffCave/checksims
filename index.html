<!DOCTYPE html>
<html>
<head>

 <script async src='https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.5/jszip.min.js'></script>
 <script async src='https://cdnjs.cloudflare.com/ajax/libs/jsSHA/2.3.1/sha.js'></script>
 <script async src='https://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.3.0/mustache.min.js'></script>
 <script async src='https://cdnjs.cloudflare.com/ajax/libs/d3/4.13.0/d3.min.js'></script>
 <script async src="https://cdnjs.cloudflare.com/ajax/libs/pouchdb/6.4.3/pouchdb.min.js" integrity="sha256-KCHhiEhNiEbEd8h607QOlmc3LkpQ/En/mS302LGjnLY=" crossorigin="anonymous"></script>
 <script async src="https://unpkg.com/esprima@~4.0/dist/esprima.js"></script>
 <script async src="https://unpkg.com/filbert@0.1.20/filbert.js"></script>

 <script async src="https://unpkg.com/vue/dist/vue.js"></script>
 <script async src="https://unpkg.com/vue-material@beta"></script>
 <script async src='https://unpkg.com/vuetify/dist/vuetify.js'></script>
 <script async src="https://unpkg.com/http-vue-loader"></script>


 <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,500,700,400italic|Material+Icons">
 <link rel="stylesheet" href="//unpkg.com/vue-material@beta/dist/theme/default.css">
 <link rel="shortcut icon" type="image/png" href="favicon.png"/>

 <script type="module" src="./scripts/index.js"></script>
 <script type="text/javascript" nomodule>
    let everything = Array.from(document.querySelectorAll('body > *'));
    everything.forEach(function(d){
        d.style.display = 'none';
    });
    let instructions = document.body.querySelector('#unsupported');
    instructions.style.display = 'block';
 </script>

 <template type="text/x-template" id="treeview-template">
  <details style='margin-left:1em;' draggable='true' @dragstart='dragstart' :data-path='filecollection.path' open>
   <summary> {{ filecollection.name }} </summary>
   <treeview v-for="(filecollection, index) in filecollection.children" :key="index" :files="filecollection"></item>
  </details>
 </template>
 <template type='text/x-template' id='submission-template'>
  <details>
   <summary>
    <!-- button @click='showhide' title='Display'><span v-html="showhideIcon"></span></button -->
    <button @click='remove' title='Delete' v-show='remover !== null'>&#128465;</button>
    <!-- span @click='save'>&#128427;</span -->
    {{submission.name}}
   </summary>
   <treeview :files="submission.content"></treeview>
  </details>
 </template>
 <template type='text/x-template' id='submissions-template'>
  <div>
   <submission v-for='(sub,key) in ordered' :key="sub.name" :submission="sub" :remover='remover' ></submission>
  </div>
 </template>
 <template type='text/x-template' id='tornadoresult-template'>
   <table>
    <tbody>
     <tr v-for='(result,key) in ordered' :class="{complete:isComplete(result),significant:isComplete(result) && report.isSignificantResult(result)}" :key="result.name">
      <td v-for='submission in result.submissions'><meter min='0' max='1' :value='submission.percentMatched' :title='formatTitle(submission.percentMatched)'></meter><span :title='formatTitle(submission.percentMatched)'>{{submission.name}}</span></td>
     </tr>
    </tbody>
   </table>
 </template>
 <template type='text/x-template' id='forcedirected-template'>
  <svg>
   <g class='links'>
    <line
        v-for='link in links'
        :stroke='link.complete===1?opts.lineColour:"orange"'
        :stroke-width='Math.floor((opts.radius+1)*link.value)'
        :opacity='link.value'
        :x1='link.points[0].pos.x'
        :y1='link.points[0].pos.y'
        :x2='link.points[1].pos.x'
        :y2='link.points[1].pos.y'
        />
   </g>
   <g class='nodes'>
    <circle
        v-for='node in nodes'
        :cx='node.pos.x'
        :cy='node.pos.y'
        :r='opts.radius'
        :fill='opts.nodeColour[node.group]'
        @mousedown='MouseDown'
        >
     <title>{{node.key}}</title>
    </circle>
   </g>
  </svg>
 </template>
 <template type='text/x-template' id='resultmatrixcell-template'>
  <span :style='style' :title='title'>&#9646;</span>
 </template>
 <template type='text/x-template' id='resultmatrix-template'>
  <table style='table-layout:fixed;'>
   <thead>
    <tr>
     <th>&nbsp;</th>
     <th v-for='submission in orderedSubmissions'><span>{{submission.name}}</span></th>
    </tr>
   </thead>
   <tbody>
    <tr v-for='(row,i) in orderedSubmissions' :key='row.name'>
     <th>{{row.name}}</th>
     <td v-for='(col,j) in orderedSubmissions' :key='col.name' style='margin:0;padding:0;background-color:transparent;position:relative;overflow:hidden;width:1em;height:1em;'>
      <resultmatrixcell :result-submission='getResultSubmission(row,col)' :parent='getResult(row,col)' :is-same='i===j'></resultmatrixcell>
     </td>
    </tr>
   </tbody>
  </table>
 </template>


 <link rel='stylesheet' href='index.css' />
 <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
</head>
<body>
 <nav style='display:none;'>
  <progress  value='1' min='0' max='2'>asdf</progress>
  <input type='range' id='menu' value='0' min='0' max='3' list='forms' />
  <datalist id='forms'>
   <option value='0'>A</option>
   <option value='1'>B</option>
   <option value='2'>C</option>
   <option value='3'>D</option>
  </datalist>
 </nav>
 <main>
  <section>
   <i>help</i>
   <h1>Sample Files</h1>
   <dl>
    <dt><a href='./tests/sampleassignment.zip'>Sample Assignments</a></dt>
     <dd>
      A few demo files that I have used in classes. Formatted
      appropriately for student submission, and copied a couple of way.
      Gives some data that will match and some data that will not match.
     </dd>
    <dt><a href='./tests/smallcompares.zip'>Small Compares</a></dt>
     <dd>
      Two files with a very small comparison dataset. Suitable for debugging,
      and manually tracing of the algorithm.
      <ol>
       <li><pre><a href="https://en.wikipedia.org/wiki/Coelacanth">C O E L A C A N T H</a></pre></li>
       <li><pre>  P E L I C A N</pre></li>
      </ol>
      From a bioinformatics class slides I <a href="http://slideplayer.com/slide/5142106/16/images/21/Smith-Waterman-Algorithm.jpg">found online</a>
     </dd>
    <dt><a href='./tests/bigcompares.zip'>Big Compares</a></dt>
     <dd>
      Genome of E.Coli, and Y.Pestarius. Makes for a really big compare,
      and is know to currently break the application.
     </dd>
   </dl>
  </section>
  <section id='files'>
   <i>folder</i>
   <h1>Files</h1>
   <filedrop :onfile="onfile">&#128476; Upload a Zip</filedrop>
   <treeview :filelist="treeData"></treeview>
  </section>
  <section id='submissions'>
   <i>collections</i>
   <h1>Submissions</h1>
   <span id='submissionMaker'>&#10133;</span>
   <submission-list :pouchdb='db' :filter='filter'></submission-list>
  </section>
  <section id='results'>
   <i>show_chart</i>
   <h1>Reports</h1>
   <details data-type='force' open>
    <summary>Force</summary>
    <forcedirected :width='300' :height="300" :results='report.results'></forcedirected>
   </details>
   <details data-type='lst' open>
    <summary>Listing</summary>
    <tornadoresult-list class='result' :report="report"></tornadoresult-list>
   </details>
   <details data-type='html' open>
    <summary>HTML</summary>
    <resultmatrix :report='report'></resultmatrix>
   </details>
   <details data-type='csv'>
    <summary>CSV</summary>
    <textarea class='result'></textarea>
   </details>
  </section>

 </main>

 <div id='unsupported' style='display:none;'>
  <h1>Experimental Features required</h1>
  <p>
   In an effort to put this together, it seemed a good idea to use some JavaScript v6 features. Unfortunately, it appears that your browser does not currently support them <strong>by default</strong>
  </p>
  <p>
   Don't Panic!! As of 2018, most browsers don't; however most allow you to turn the features on.
  </p>
  <h2>Chrome</h2>
  <ol>
   <li>Navigate to <a href='chrome://flags/'>Chrome Experiments</a></li>
   <li>Activate <a href='chrome://flags/#enable-javascript-harmony'>"Experimental Javascript"</a></li>
   <li>Activate <a href='chrome://flags/#enable-experimental-web-platform-features'>"Experimental Web Platform Features"</a></li>
  </ol>
  <h2>Edge</h2>
  <ol>
   <li>Navigate to <a href='about:flags'>Edge Flags</a></li>
   <li>Activate "Experimental Javascript"</li>
  </ol>
 </div>

</body>
</html>
